<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">

<script type="text/javascript" src="<?php echo CFG_PUBLIC_PATH; ?>/kr/jQuery/ui/jquery-ui.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
	$("#r_day").datepicker({
		dateFormat : 'yy-mm-dd',
		monthNames: ['1월(JAN)','2월(FEB)','3월(MAR)','4월(APR)','5월(MAY)','6월(JUN)', '7월(JUL)','8월(AUG)','9월(SEP)','10월(OCT)','11월(NOV)','12월(DEC)'],
		monthNamesShort: ['1월','2월','3월','4월','5월','6월', '7월','8월','9월','10월','11월','12월'],
		dayNames: ['일','월','화','수','목','금','토'],
		dayNamesShort: ['일','월','화','수','목','금','토'],
		dayNamesMin: ['일','월','화','수','목','금','토'],
		weekHeader: 'Wk',
		firstDay: 0,
		isRTL: false,
		changeMonth : true,
		changeYear : true,
		minDate: '-100y',
		 yearRange: 'c-100:c+10',
		showMonthAfterYear : true,
		autoSize : false
	});
});



$(function(){
	$(".onlynum").keyup(function(){$(this).val( $(this).val().replace(/[^0-9]/g,"") );} );
});

function check_spam_code()
{
	var f = document.add_form;
	var idx = <?=$idx;?>

	if (isBlank(f.r_security.value))
	{
		alert("보안코드를 입력해주세요.");
		return;
	}
	else
	{
		$.ajax({
			type: f.method,
			url: f.action,
			data: "folder="+ f.folder.value +"&page=rproc&url=ajax&mode=check_code&r_security="+ f.r_security.value + "&idx="+ idx,
			success: function(data) {
				if (data == "ok"){
					f.submit();
				}
				else
				{
					alert("보안코드가 맞지 않습니다.");
					f.b_security.focus();
				}
			},
			error: function(msg) { alert("error"); }
		});
	}
}

function check_add_form() {
	var f = document.add_form;


	var index = $("#r_time_id option").index($("#r_time_id option:selected"));


	if(isBlank(f.medical_sel.value)) {
		alert("진료과목을 입력해주세요.");
		f.medical_sel.focus();
		return;
	}


	else if(isBlank(f.r_day.value)) {
		alert("예약일을 입력해주세요.");
		f.r_day.focus();
		return;
	}


	else if(index == 0) {
		alert("예약시간을 선택해주세요.");
		f.r_time.focus();
		return;
	}


	else if(isBlank(f.r_name.value)) {
		alert("이름을 입력해주세요.");
		f.r_name.focus();
		return;
	}

	else if (isBlank(f.hp1.value))
	{
		alert("연락처을 입력해주세요.");
		f.hp1.focus();
	}

	else if (isBlank(f.hp2.value))
	{
		alert("연락처을 입력해주세요.");
		f.hp2.focus();
	}
	else if (isBlank(f.hp3.value))
	{
		alert("연락처을 입력해주세요.");
		f.hp3.focus();
	}

	else if (isBlank(f.email_id.value) || isBlank(f.email_domain.value))
	{
		alert("이메일을 입력해주세요.");
		f.email_id.focus();
	}

	else 
	{
		oEditors.getById["txt_content"].exec("UPDATE_CONTENTS_FIELD", []);	// 에디터의 내용이 textarea에 적용됩니다.
		check_spam_code();
	}
}
</script>
<div id="content">
    <div class="visual bg8">
        <p class="tit">커뮤니티<em></em>진료예약</p>
        <p class="txt">달맞이한의원은 1대1 처방에 의한 맞춤 한약으로 질병을 개선합니다.</p>
    </div>
    <div class="top">
        <div class="navi">
            <a href="#"><img src="/_public/images/sub/icon_home.png" alt=""></a>
            <a href="#">커뮤니티</a>
            <a href="#" class="bold">진료예약</a>
        </div>
        <strong class="p-tit">진료예약</strong>
    </div>
    <div class="community">
        <div class="outline-box">
            <div class="content-box">
                <div class="reservation">
                    <p class="txt">달맞이한의원과 함께 내 몸에 잠들어 있는 자연치유력을 깨우십시오!</p>
                    <p class="txt">항상 열려있는 마음으로 고객 여러분을 맞이하겠습니다.</p>
                    <p class="tit">예약일 선택</p>
                    <ul>
                        <li>핸드폰 번호는 온라인 예약 확인 시 필요한 정보 이므로 정확하게 적어주세요.</li>
                        <li>예약 변경 및 취소는 예약일 하루 전까지 전화를 주시면 변경해 드리겠습니다.</li>
                        <li>문의 전화 : 051-746-7711</li>
                    </ul>
                    <div class="calendar">
                        <div class="top">
                            <button type="button" class="prev">&lt;&lt;</button>
                            <span>2020.02</span>
                            <button type="button" class="next">&gt;&gt;</button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>일요일</th>
                                    <th>월요일</th>
                                    <th>화요일</th>
                                    <th>수요일</th>
                                    <th>목요일</th>
                                    <th>금요일</th>
                                    <th>토요일</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="color-red"></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td class="color-blue">1</td>
                                </tr>
                                <tr>
                                    <td class="color-red">2</td>
                                    <td>3</td>
                                    <td>4</td>
                                    <td>5</td>
                                    <td>6</td>
                                    <td>7</td>
                                    <td class="color-blue">8</td>
                                </tr>
                                <tr>
                                    <td class="color-red">9</td>
                                    <td>10</td>
                                    <td>11</td>
                                    <td>12</td>
                                    <td>13</td>
                                    <td>14</td>
                                    <td class="color-blue">15</td>
                                </tr>
                                <tr>
                                    <td class="color-red">16</td>
                                    <td>17</td>
                                    <td>18</td>
                                    <td>19</td>
                                    <td>20</td>
                                    <td>21</td>
                                    <td class="color-blue">22</td>
                                </tr>
                                <tr>
                                    <td class="color-red">23</td>
                                    <td>24</td>
                                    <td>25</td>
                                    <td>26</td>
                                    <td>27</td>
                                    <td>28</td>
                                    <td class="color-blue">29</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="tit">예약정보 입력</p>
					<form name="add_form" action="/" method="post" onSubmit="return false;">
					<input type="hidden" name="folder" value="<?php echo $folder?>"/>
					<input type="hidden" name="page" value="rproc"/>
					<input type="hidden" name="mode" value="add"/>
					<input type="hidden" name="idx" value="<?=$idx;?>"/>
                        <fieldset>
                            <div class="piw-form-group">
                                <span class="label">진료과목</span>
                                <div class="piw-form">
                                    <label for="medical_sel">진료과목</label>
                                    <select id="medical_sel" name="medical_sel">
                                        <option value="">진료과목</option>
                                        <option value="a">불면증</option>
                                        <option value="b">피부질환(아토피)</option>
                                        <option value="c">암치료</option>
                                        <option value="d">두통</option>
                                        <option value="e">수족냉증</option>
                                        <option value="f">해독</option>
                                        <option value="g">기타</option>
                                    </select>
                                </div>
                            </div>
                            <div class="piw-form-group reserv-date">
                                <span class="label">예약일</span>
                                <div class="piw-form">
                                    <label for="r_day">예약일</label>
                                    <input type="text" id="r_day" name="r_day" readonly>
                                </div>
                            </div>

                            <div class="piw-form-group">
                                <span class="label">예약시간</span>
                                <div class="piw-form">
                                    <label for="inputYear">예약시간</label>
                                    <select name="r_time" id="r_time_id">
                                        <option value="">선택하세요</option>
                                        <option value="9">오전 09:00</option>
                                        <option value="10">오전 10:00</option>
                                        <option value="11">오전 11:00</option>
                                        <option value="12">오후 12:00</option>
                                        <option value="13">오후 01:00</option>
                                        <option value="14">오후 02:00</option>
                                        <option value="15">오후 03:00</option>
                                        <option value="16">오후 04:00</option>
                                        <option value="17">오후 05:00</option>
                                        <option value="18">오후 06:00</option>
                                        <option value="19">오후 07:00</option>
                                        <option value="20">오후 08:00</option>
                                    </select>
                                </div>
                            </div>
                            <div class="piw-form-group">
                                <span class="label">이름</span>
                                <div class="piw-form">
                                    <label for="r_name">이름</label>
                                    <input type="text" id="r_name" name="r_name" placeholder="이름을 입력 하세요.">
                                    <p class="info-txt">* 반드시 실명으로 기재해주세요.</p>
                                </div>
                            </div>
                            <div class="piw-form-group tel">
                                <span class="label">연락처</span>
                                <div class="piw-form">
                                    <label for="inputTel">연락처</label>
									<?=make_select_form('hp1', $fullphone, '',"");?>
                                    <em>-</em>
                                    <input type="text" id="hp2" name="hp2" maxlength=4 placeholder="" class="onlynum">
                                    <em>-</em>
                                    <input type="text" id="hp3" name="hp3"  maxlength=4 placeholder="" class="onlynum">
                                </div>
                            </div>
                            <div class="piw-form-group email">
                                <span class="label">이메일</span>
                                <div class="piw-form">
                                    <label for="inputEmail">이메일</label>
                                    <input type="text" id="inputEmail" name="email_id" style="ime-mode:disabled">
                                    <em>@</em>
                                    <input type="text" name="email_domain" size="20" style="ime-mode:disabled" readOnly>
									<?php echo make_select_form("mail_domain", $email_address, " onChange='insert_domain(this.form);' style='padding:3px;'", ""); ?>
                                </div>
                            </div>
                            <div class="piw-form-group email">
                                <span class="label">내용</span>
                                <div class="piw-form">
                                    <label for="inputEmail">내용</label>
                                    <textarea name="txt_content" id="txt_content" rows="10" cols="100" style="width:100%; height:250px; display:none"></textarea>
                                </div>
                            </div>
							<div class="piw-form-group">
                                <span class="label">보안코드</span>
                                <div class="piw-form code">
                                    <label for="r_security">보안코드</label>
									<em><?=$temp_secret;?></em>
                                    <input type="text" id="r_security" class="secret-code" name="r_security" value="">
                                </div>
                            </div>
                        </fieldset>
						<div class="piw-btn-box">
							<button type="button" class="piw-btn piw-btn-blue" onClick="check_add_form();">예약하기</button>
						</div>
					</form>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="<?php echo CFG_PUBLIC_PATH; ?>/smart_editor/js/HuskyEZCreator.js" charset="utf-8"></script>
<script type="text/javascript">
var oEditors = [];

// 추가 글꼴 목록
//var aAdditionalFontSet = [["MS UI Gothic", "MS UI Gothic"], ["Comic Sans MS", "Comic Sans MS"],["TEST","TEST"]];

nhn.husky.EZCreator.createInIFrame({
	oAppRef: oEditors,
	elPlaceHolder: "txt_content",
	sSkinURI: "<?php echo CFG_PUBLIC_PATH; ?>/smart_editor/SmartEditor2Skin.html",
	htParams : {
		bUseToolbar : true,				// 툴바 사용 여부 (true:사용/ false:사용하지 않음)
		bUseVerticalResizer : true,		// 입력창 크기 조절바 사용 여부 (true:사용/ false:사용하지 않음)
		bUseModeChanger : true,			// 모드 탭(Editor | HTML | TEXT) 사용 여부 (true:사용/ false:사용하지 않음)
		//aAdditionalFontList : aAdditionalFontSet,		// 추가 글꼴 목록
		fOnBeforeUnload : function(){
			//alert("완료!");
		}
	}, //boolean
	fOnAppLoad : function(){
		//예제 코드
		//oEditors.getById["ir1"].exec("PASTE_HTML", ["로딩이 완료된 후에 본문에 삽입되는 text입니다."]);
	},
	fCreator: "createSEditor2"
});
</script>